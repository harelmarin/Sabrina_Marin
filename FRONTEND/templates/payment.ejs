<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paiement</title>
    <link rel="stylesheet" href="../assets/css/payment.css">
    <script src="https://js.stripe.com/v3/"></script>
    <script src="../assets/js/paymentStripe.js" defer></script>
</head>
<body>
    <form id="payment-form">
        <div id="total-amount-div"></div>
        <div class="div-container">
            <label for="address">Nom</label>
            <input type="text" id="name" name="name" required minlength="3">
        </div>
        
        <div class="div-container">
            <label for="address">Prénom</label>
            <input type="text" id="firstname" name="firstname" required minlength="3">
        </div>
        
        <div class="div-container">
            <label for="address">Email</label>
            <input type="email" id="email" name="email" required>
        </div>

        <div class="div-container">
            <label for="address">Adresse</label>
            <input type="text" id="addresse" name="addresse" autocomplete="off" required>
            <ul id="suggestions" style="border: 1px solid #ccc; list-style: none; padding: 0;"></ul>
        </div>
        <div class="div-container">
            <label for="card-element">Carte de crédit ou de débit</label>
            <div id="card-element"></div>
        </div>
      
        <button type="submit">Payer</button>
        <div id="card-errors" role="alert"></div>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const addressInput = document.getElementById('address');
            const suggestionsList = document.getElementById('suggestions');

            addressInput.addEventListener('input', async function () {
                const query = addressInput.value;

                if (query.length < 3) {
                    suggestionsList.innerHTML = '';
                    return;
                }

                const response = await fetch(`https://data.geopf.fr/geocodage/completion?text=${query}&type=PositionOfInterest,StreetAddress&maximumResponses=5`);
                const data = await response.json();

                if (data.status === 'OK') {
                    suggestionsList.innerHTML = '';

                    data.results.forEach(result => {
                        const listItem = document.createElement('li');
                        listItem.textContent = result.fulltext;
                        listItem.style.cursor = 'pointer';

                        listItem.addEventListener('click', function () {
                            addressInput.value = result.fulltext;
                            suggestionsList.innerHTML = '';
                        });

                        suggestionsList.appendChild(listItem);
                    });
                }
            });
        });
    </script>
</body>
</html>
